!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.html5ImgCompress=t():e.html5ImgCompress=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n=window.webpackJsonphtml5ImgCompress;window.webpackJsonphtml5ImgCompress=function(r,o){for(var i,s,c=0,l=[];c<r.length;c++)s=r[c],a[s]&&l.push.apply(l,a[s]),a[s]=0;for(i in o)e[i]=o[i];for(n&&n(r,o);l.length;)l.shift().call(null,t)};var r={},a={3:0};return t.e=function(e,n){if(0===a[e])return n.call(null,t);if(void 0!==a[e])a[e].push(n);else{a[e]=[n];var r=document.getElementsByTagName("head")[0],o=document.createElement("script");o.type="text/javascript",o.charset="utf-8",o.async=!0,o.src=t.p+""+e+".chunk.min.js",r.appendChild(o)}},t.m=e,t.c=r,t.p="",t(0)}([function(e,t,n){var r,a;r=[],a=function(){function e(t,n){var r=e.DEFAULTE;this.file=t,this.options={};for(var a in r)this.options[a]=null==n[a]?r[a]:n[a];this.init()}var t=navigator.userAgent,r=~t.indexOf("MicroMessenger"),a=~t.indexOf("Android"),o=function(){var e=navigator.userAgent.match(/(\d)_\d like Mac OS/);return e&&e[1]<=7}(),i=window.URL||window.webkitURL,s=document.scripts,c=s[s.length-1].src;return n.p=c.substr(0,c.lastIndexOf("/")+1),e.prototype={init:function(){i&&File&&document.createElement("canvas").getContext?this.read(this.file):this.options.notSupport()},read:function(e){var t,s,c,l,u,d,f,h,g,m=this,p=new Image,v=i.createObjectURL(e);m.options.before(e)!==!1&&(p.src=v,p.onload=function(){h=function(i){if(u=m.options.quality,t=m.getSize(p,i),s=document.createElement("canvas"),s.width=t.width,s.height=t.height,c=s.getContext("2d"),o)n.e(0,function(t){var n=[t(3)];(function(t){l=new t(p),g={maxWidth:s.width,maxHeight:s.height,orientation:i},~"68".indexOf(i)&&(g.maxWidth=s.height,g.maxHeight=s.width),l.render(s,g),f=s.toDataURL("image/jpeg",u),m.handler("done",s,p,v,f,e)}).apply(null,n)});else{switch(i){case 3:c.rotate(180*Math.PI/180),c.drawImage(p,-s.width,-s.height,s.width,s.height);break;case 6:c.rotate(90*Math.PI/180),c.drawImage(p,0,-s.width,s.height,s.width);break;case 8:c.rotate(270*Math.PI/180),c.drawImage(p,-s.height,0,s.height,s.width);break;default:c.drawImage(p,0,0,s.width,s.height)}a&&r?n.e(1,function(t){var n=[t(2)];(function(t){d=new t,f=d.encode(c.getImageData(0,0,s.width,s.height),100*u),m.handler("done",s,p,v,f,e)}).apply(null,n)}):f=s.toDataURL("image/jpeg",u),m.handler("done",s,p,v,f,e)}},a?h():n.e(2,function(e){var t=[e(1)];(function(e){e.getData(p,function(){h(e.getTag(this,"Orientation"))})}).apply(null,t)})},p.onerror=function(){m.handler("fail",s,p,v,f,e)})},handler:function(e,t,n,r,a,o){t=null,n=null,i.revokeObjectURL(r),this.options[e](o,a),this.options.complate(o)},getSize:function(e,t){var n,r=this.options,a=r.maxWidth,o=r.maxHeight,i=e.width,s=e.height;return~"68".indexOf(t)&&(i=e.height,s=e.width),n=i/s,a&&o?n>=a/o?i>a&&(s=a/n,i=a):s>o&&(i=o*n,s=o):a?i>a&&(s=a/n,i=a):o&&s>o&&(i=o*n,s=o),{width:i,height:s}}},e.DEFAULTE={maxWidth:1e3,maxHeight:1e3,quality:.6,before:function(){},done:function(){},fail:function(){},complate:function(){},notSupport:function(){}},window.html5ImgCompress=e}.apply(t,r),!(void 0!==a&&(e.exports=a))}])});